import{s as le,e as P,u as j,g as R,f as Y,h as me,n as z,k as X}from"../chunks/scheduler.a6287574.js";import{S as ne,i as re,g as $,s as U,h as C,j as D,f as _,c as I,k as m,a as S,x as p,d as T,t as A,r as M,B as q,u as N,v as F,w as H,m as oe,n as ie,A as ue,D as fe}from"../chunks/index.3e76b7a6.js";import{p as Z,U as G}from"../chunks/stores.10c58602.js";import{I as J}from"../chunks/Input.ae2cab64.js";import"../chunks/paths.1b4de03e.js";import{v as x}from"../chunks/utils.85594516.js";import"../chunks/Toaster.svelte_svelte_type_style_lang.3e69948a.js";import{u as ce,a as de}from"../chunks/schemas.0ec87125.js";const he=l=>({}),ee=l=>({}),_e=l=>({}),te=l=>({}),ge=l=>({}),se=l=>({});function pe(l){let e,s,a,r,h,i,d,E,o,n,u,g;const k=l[3].trigger,w=P(k,l,l[2],se),L=l[3].heading,b=P(L,l,l[2],te),O=l[3].default,v=P(O,l,l[2],null),B=l[3].actions,f=P(B,l,l[2],ee);return{c(){e=$("label"),w&&w.c(),s=U(),a=$("input"),r=U(),h=$("label"),i=$("label"),d=$("div"),b&&b.c(),E=U(),o=$("div"),v&&v.c(),n=U(),u=$("div"),f&&f.c(),this.h()},l(t){e=C(t,"LABEL",{for:!0});var c=D(e);w&&w.l(c),c.forEach(_),s=I(t),a=C(t,"INPUT",{type:!0,id:!0,class:!0}),r=I(t),h=C(t,"LABEL",{for:!0,class:!0});var y=D(h);i=C(y,"LABEL",{for:!0,class:!0});var V=D(i);d=C(V,"DIV",{class:!0});var K=D(d);b&&b.l(K),K.forEach(_),E=I(V),o=C(V,"DIV",{class:!0});var Q=D(o);v&&v.l(Q),Q.forEach(_),n=I(V),u=C(V,"DIV",{class:!0});var W=D(u);f&&f.l(W),W.forEach(_),V.forEach(_),y.forEach(_),this.h()},h(){m(e,"for",l[0]),m(a,"type","checkbox"),m(a,"id",l[0]),m(a,"class","modal-toggle"),a.checked=l[1],m(d,"class","font-bold text-xl text-center"),m(o,"class","my-2"),m(u,"class","modal-action justify-center"),m(i,"for",""),m(i,"class","modal-box"),m(h,"for",l[0]),m(h,"class","modal modal-bottom sm:modal-middle ")},m(t,c){S(t,e,c),w&&w.m(e,null),S(t,s,c),S(t,a,c),S(t,r,c),S(t,h,c),p(h,i),p(i,d),b&&b.m(d,null),p(i,E),p(i,o),v&&v.m(o,null),p(i,n),p(i,u),f&&f.m(u,null),g=!0},p(t,[c]){w&&w.p&&(!g||c&4)&&j(w,k,t,t[2],g?Y(k,t[2],c,ge):R(t[2]),se),(!g||c&1)&&m(e,"for",t[0]),(!g||c&1)&&m(a,"id",t[0]),(!g||c&2)&&(a.checked=t[1]),b&&b.p&&(!g||c&4)&&j(b,L,t,t[2],g?Y(L,t[2],c,_e):R(t[2]),te),v&&v.p&&(!g||c&4)&&j(v,O,t,t[2],g?Y(O,t[2],c,null):R(t[2]),null),f&&f.p&&(!g||c&4)&&j(f,B,t,t[2],g?Y(B,t[2],c,he):R(t[2]),ee),(!g||c&1)&&m(h,"for",t[0])},i(t){g||(T(w,t),T(b,t),T(v,t),T(f,t),g=!0)},o(t){A(w,t),A(b,t),A(v,t),A(f,t),g=!1},d(t){t&&(_(e),_(s),_(a),_(r),_(h)),w&&w.d(t),b&&b.d(t),v&&v.d(t),f&&f.d(t)}}}function be(l,e,s){let{$$slots:a={},$$scope:r}=e,{label:h}=e,{checked:i}=e;return l.$$set=d=>{"label"in d&&s(0,h=d.label),"checked"in d&&s(1,i=d.checked),"$$scope"in d&&s(2,r=d.$$scope)},[h,i,r,a]}class ae extends ne{constructor(e){super(),re(this,e,be,pe,le,{label:0,checked:1})}}function ve(l){let e,s,a,r,h,i,d,E;return s=new J({props:{id:"email",type:"email",label:"Enter your new email address",required:!0,value:l[4]?.email,disabled:l[3],errors:l[0]?.email}}),{c(){e=$("form"),M(s.$$.fragment),a=U(),r=$("button"),h=oe("Change my email"),this.h()},l(o){e=C(o,"FORM",{class:!0});var n=D(e);N(s.$$.fragment,n),a=I(n),r=C(n,"BUTTON",{type:!0,class:!0});var u=D(r);h=ie(u,"Change my email"),u.forEach(_),n.forEach(_),this.h()},h(){m(r,"type","submit"),m(r,"class","btn btn-primary w-full"),r.disabled=l[3],m(e,"class","space-y-2")},m(o,n){S(o,e,n),F(s,e,null),p(e,a),p(e,r),p(r,h),i=!0,d||(E=ue(e,"submit",fe(l[5])),d=!0)},p(o,n){const u={};n&16&&(u.value=o[4]?.email),n&8&&(u.disabled=o[3]),n&1&&(u.errors=o[0]?.email),s.$set(u),(!i||n&8)&&(r.disabled=o[3])},i(o){i||(T(s.$$.fragment,o),i=!0)},o(o){A(s.$$.fragment,o),i=!1},d(o){o&&_(e),H(s),d=!1,E()}}}function $e(l){let e,s="Change Email";return{c(){e=$("span"),e.textContent=s,this.h()},l(a){e=C(a,"SPAN",{slot:!0,class:!0,"data-svelte-h":!0}),q(e)!=="svelte-9sdvrr"&&(e.textContent=s),this.h()},h(){m(e,"slot","trigger"),m(e,"class","btn btn-primary")},m(a,r){S(a,e,r)},p:z,d(a){a&&_(e)}}}function Ce(l){let e,s="Change Your Email";return{c(){e=$("h3"),e.textContent=s,this.h()},l(a){e=C(a,"H3",{slot:!0,"data-svelte-h":!0}),q(e)!=="svelte-17xdt4"&&(e.textContent=s),this.h()},h(){m(e,"slot","heading")},m(a,r){S(a,e,r)},p:z,d(a){a&&_(e)}}}function Ee(l){let e,s,a,r,h,i,d,E;return s=new J({props:{id:"username",type:"text",label:"Enter your new username",required:!0,value:l[4]?.username,disabled:l[3],errors:l[0]?.username}}),{c(){e=$("form"),M(s.$$.fragment),a=U(),r=$("button"),h=oe("Change my username"),this.h()},l(o){e=C(o,"FORM",{class:!0});var n=D(e);N(s.$$.fragment,n),a=I(n),r=C(n,"BUTTON",{type:!0,class:!0});var u=D(r);h=ie(u,"Change my username"),u.forEach(_),n.forEach(_),this.h()},h(){m(r,"type","submit"),m(r,"class","btn btn-primary w-full"),r.disabled=l[3],m(e,"class","space-y-2")},m(o,n){S(o,e,n),F(s,e,null),p(e,a),p(e,r),p(r,h),i=!0,d||(E=ue(e,"submit",fe(l[6])),d=!0)},p(o,n){const u={};n&16&&(u.value=o[4]?.username),n&8&&(u.disabled=o[3]),n&1&&(u.errors=o[0]?.username),s.$set(u),(!i||n&8)&&(r.disabled=o[3])},i(o){i||(T(s.$$.fragment,o),i=!0)},o(o){A(s.$$.fragment,o),i=!1},d(o){o&&_(e),H(s),d=!1,E()}}}function we(l){let e,s="Change Username";return{c(){e=$("span"),e.textContent=s,this.h()},l(a){e=C(a,"SPAN",{slot:!0,class:!0,"data-svelte-h":!0}),q(e)!=="svelte-zatoj7"&&(e.textContent=s),this.h()},h(){m(e,"slot","trigger"),m(e,"class","btn btn-primary")},m(a,r){S(a,e,r)},p:z,d(a){a&&_(e)}}}function ke(l){let e,s="Change Your Username";return{c(){e=$("h3"),e.textContent=s,this.h()},l(a){e=C(a,"H3",{slot:!0,"data-svelte-h":!0}),q(e)!=="svelte-1vcd90i"&&(e.textContent=s),this.h()},h(){m(e,"slot","heading")},m(a,r){S(a,e,r)},p:z,d(a){a&&_(e)}}}function De(l){let e,s,a,r="Change Email",h,i,d,E,o,n,u,g="Change Username",k,w,L,b,O,v,B;return E=new ae({props:{label:"change-email",checked:l[1],$$slots:{heading:[Ce],trigger:[$e],default:[ve]},$$scope:{ctx:l}}}),b=new J({props:{id:"username",label:"Username",value:l[4]?.username,disabled:!0}}),v=new ae({props:{label:"change-username",checked:l[2],$$slots:{heading:[ke],trigger:[we],default:[Ee]},$$scope:{ctx:l}}}),{c(){e=$("div"),s=$("div"),a=$("h3"),a.textContent=r,h=U(),i=$("div"),d=U(),M(E.$$.fragment),o=U(),n=$("div"),u=$("h3"),u.textContent=g,k=U(),w=$("div"),L=U(),M(b.$$.fragment),O=U(),M(v.$$.fragment),this.h()},l(f){e=C(f,"DIV",{class:!0});var t=D(e);s=C(t,"DIV",{class:!0});var c=D(s);a=C(c,"H3",{class:!0,"data-svelte-h":!0}),q(a)!=="svelte-v7b2pk"&&(a.textContent=r),h=I(c),i=C(c,"DIV",{class:!0}),D(i).forEach(_),d=I(c),N(E.$$.fragment,c),c.forEach(_),o=I(t),n=C(t,"DIV",{class:!0});var y=D(n);u=C(y,"H3",{class:!0,"data-svelte-h":!0}),q(u)!=="svelte-q0uue2"&&(u.textContent=g),k=I(y),w=C(y,"DIV",{class:!0}),D(w).forEach(_),L=I(y),N(b.$$.fragment,y),O=I(y),N(v.$$.fragment,y),y.forEach(_),t.forEach(_),this.h()},h(){m(a,"class","text-2xl font-medium"),m(i,"class","divider"),m(s,"class","w-full"),m(u,"class","text-2xl font-medium"),m(w,"class","divider mb-0.5"),m(n,"class","w-full"),m(e,"class","flex flex-col w-full h-full space-y-12")},m(f,t){S(f,e,t),p(e,s),p(s,a),p(s,h),p(s,i),p(s,d),F(E,s,null),p(e,o),p(e,n),p(n,u),p(n,k),p(n,w),p(n,L),F(b,n,null),p(n,O),F(v,n,null),B=!0},p(f,[t]){const c={};t&2&&(c.checked=f[1]),t&153&&(c.$$scope={dirty:t,ctx:f}),E.$set(c);const y={};t&16&&(y.value=f[4]?.username),b.$set(y);const V={};t&4&&(V.checked=f[2]),t&153&&(V.$$scope={dirty:t,ctx:f}),v.$set(V)},i(f){B||(T(E.$$.fragment,f),T(b.$$.fragment,f),T(v.$$.fragment,f),B=!0)},o(f){A(E.$$.fragment,f),A(b.$$.fragment,f),A(v.$$.fragment,f),B=!1},d(f){f&&_(e),H(E),H(b),H(v)}}}function ye(l,e,s){let a;me(l,G,n=>s(4,a=n));let r,h=!1,i=!1,d=!1;async function E(n){const{formData:u,err:g}=await x(new FormData(n.target),ce);if(s(0,r=g?.fieldErrors),!g){s(3,d=!0),s(1,h=!0);try{const{email:k}=await Z.collection("users").requestEmailChange(u.email);X(G,a.email=k,a),s(1,h=!1)}catch(k){console.log(k.status,k.data)}s(3,d=!1)}}async function o(n){const{formData:u,err:g}=await x(new FormData(n.target),de);if(s(0,r=g?.fieldErrors),!g){s(3,d=!0),s(2,i=!0);try{const{username:k}=await Z.collection("users").update(a.id,{username:u.username});X(G,a.username=k,a)}catch(k){console.log("This username has already been taken! Try another."),console.log(k.status,k.data)}s(3,d=!1),s(2,i=!1)}}return[r,h,i,d,a,E,o]}class Oe extends ne{constructor(e){super(),re(this,e,ye,De,le,{})}}export{Oe as component};
