import{S as ve,i as we,s as _e,k as s,q as x,a as y,l,m as o,r as E,h as r,c as k,n as t,b as he,H as e,R as be,Z as ge,B as ue,_ as de,$ as fe}from"../../../chunks/index-aedd6872.js";import{g as xe}from"../../../chunks/navigation-b75dba13.js";import{p as M,U as ye}from"../../../chunks/stores-3f27b470.js";import{v as Ee}from"../../../chunks/utils-04416275.js";import{l as ke}from"../../../chunks/schemas-fdc952c7.js";import{t as me}from"../../../chunks/toast-5c5c4103.js";function pe(A){let a,i,c,u,f,h,m;return{c(){a=s("div"),i=s("div"),c=de("svg"),u=de("path"),f=y(),h=s("span"),m=x("You must verify your email before you can login."),this.h()},l(v){a=l(v,"DIV",{class:!0});var p=o(a);i=l(p,"DIV",{});var P=o(i);c=fe(P,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var n=o(c);u=fe(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),o(u).forEach(r),n.forEach(r),f=k(P),h=l(P,"SPAN",{});var w=o(h);m=E(w,"You must verify your email before you can login."),w.forEach(r),P.forEach(r),p.forEach(r),this.h()},h(){t(u,"stroke-linecap","round"),t(u,"stroke-linejoin","round"),t(u,"stroke-width","2"),t(u,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),t(c,"xmlns","http://www.w3.org/2000/svg"),t(c,"class","stroke-current flex-shrink-0 h-6 w-6"),t(c,"fill","none"),t(c,"viewBox","0 0 24 24"),t(a,"class","alert alert-error shadow-lg w-full max-w-md")},m(v,p){he(v,a,p),e(a,i),e(i,c),e(c,u),e(i,f),e(i,h),e(h,m)},d(v){v&&r(a)}}}function Pe(A){let a,i,c,u,f,h,m,v,p,P,n,w,S,B,R,Y,N,z,D,L,U,C,W,F,Z,O,V,$,G,T,g,J,K,Q,X,d=A[0]&&pe();return{c(){a=s("div"),i=s("h2"),c=x("Login to your account"),u=y(),f=s("p"),h=x("Or "),m=s("a"),v=x("register"),p=x(" if you don't already have an account."),P=y(),n=s("form"),w=s("div"),S=s("label"),B=s("span"),R=x("Email"),Y=y(),N=s("input"),z=y(),D=s("div"),L=s("label"),U=s("span"),C=x("Password"),W=y(),F=s("input"),Z=y(),O=s("div"),V=s("a"),$=x("Forgot Password?"),G=y(),T=s("div"),g=s("button"),J=x("Login"),K=y(),d&&d.c(),this.h()},l(I){a=l(I,"DIV",{class:!0});var _=o(a);i=l(_,"H2",{class:!0});var ee=o(i);c=E(ee,"Login to your account"),ee.forEach(r),u=k(_),f=l(_,"P",{class:!0});var j=o(f);h=E(j,"Or "),m=l(j,"A",{href:!0,class:!0});var te=o(m);v=E(te,"register"),te.forEach(r),p=E(j," if you don't already have an account."),j.forEach(r),P=k(_),n=l(_,"FORM",{class:!0});var b=o(n);w=l(b,"DIV",{class:!0});var q=o(w);S=l(q,"LABEL",{for:!0,class:!0});var ae=o(S);B=l(ae,"SPAN",{class:!0});var re=o(B);R=E(re,"Email"),re.forEach(r),ae.forEach(r),Y=k(q),N=l(q,"INPUT",{type:!0,name:!0,class:!0}),q.forEach(r),z=k(b),D=l(b,"DIV",{class:!0});var H=o(D);L=l(H,"LABEL",{for:!0,class:!0});var se=o(L);U=l(se,"SPAN",{class:!0});var le=o(U);C=E(le,"Password"),le.forEach(r),se.forEach(r),W=k(H),F=l(H,"INPUT",{type:!0,name:!0,class:!0}),H.forEach(r),Z=k(b),O=l(b,"DIV",{class:!0});var oe=o(O);V=l(oe,"A",{href:!0,class:!0});var ne=o(V);$=E(ne,"Forgot Password?"),ne.forEach(r),oe.forEach(r),G=k(b),T=l(b,"DIV",{class:!0});var ie=o(T);g=l(ie,"BUTTON",{type:!0,class:!0});var ce=o(g);J=E(ce,"Login"),ce.forEach(r),ie.forEach(r),K=k(b),d&&d.l(b),b.forEach(r),_.forEach(r),this.h()},h(){t(i,"class","mt-2 text-center text-3xl font-bold tracking-tight text-base-content"),t(m,"href","/register"),t(m,"class","text-primary font-medium hover:cursor-pointer hover:underline"),t(f,"class","text-center mt-1"),t(B,"class","label-text"),t(S,"for","email"),t(S,"class","label font-medium pb-1"),t(N,"type","email"),t(N,"name","email"),t(N,"class","input input-bordered w-full max-w-md"),t(w,"class","form-control w-full max-w-md"),t(U,"class","label-text"),t(L,"for","password"),t(L,"class","label font-medium pb-1"),t(F,"type","password"),t(F,"name","password"),t(F,"class","input input-bordered w-full max-w-md"),t(D,"class","form-control w-full max-w-md"),t(V,"href","/reset-password"),t(V,"class","font-medium text-primary hover:cursor-pointer hover:underline"),t(O,"class","w-full max-w-md"),t(g,"type","submit"),t(g,"class","btn btn-primary w-full"),g.disabled=A[1],t(T,"class","w-full max-w-md pt-2"),t(n,"class","flex flex-col items-center space-y-2 w-full pt-4"),t(a,"class","flex flex-col items-center h-full w-full")},m(I,_){he(I,a,_),e(a,i),e(i,c),e(a,u),e(a,f),e(f,h),e(f,m),e(m,v),e(f,p),e(a,P),e(a,n),e(n,w),e(w,S),e(S,B),e(B,R),e(w,Y),e(w,N),e(n,z),e(n,D),e(D,L),e(L,U),e(U,C),e(D,W),e(D,F),e(n,Z),e(n,O),e(O,V),e(V,$),e(n,G),e(n,T),e(T,g),e(g,J),e(n,K),d&&d.m(n,null),Q||(X=be(n,"submit",ge(A[2])),Q=!0)},p(I,[_]){_&2&&(g.disabled=I[1]),I[0]?d||(d=pe(),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},i:ue,o:ue,d(I){I&&r(a),d&&d.d(),Q=!1,X()}}}function De(A,a,i){let c=!1,u=!1;async function f(h){const{formData:m,err:v}=await Ee(new FormData(h.target),ke);if(v){me.error("Invalid credentials",{position:"bottom-center"});return}i(1,u=!0);try{await M.collection("users").authWithPassword(m.email,m.password),M?.authStore?.model?.verified?(ye.set(M.authStore.model),xe("/")):(M.authStore.clear(),console.log("Email not verified!"),i(0,c=!0))}catch(p){me.error(p.data.message,{position:"bottom-center"}),console.log(p.status,p.data)}i(1,u=!1)}return[c,u,f]}class Ne extends ve{constructor(a){super(),we(this,a,De,Pe,_e,{})}}export{Ne as default};
