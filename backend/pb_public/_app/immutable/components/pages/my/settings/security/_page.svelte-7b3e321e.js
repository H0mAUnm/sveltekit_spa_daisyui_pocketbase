import{S as Q,i as W,s as X,k as c,q as H,a as P,w as R,l as w,m as h,r as T,h as i,c as x,x as k,n as o,b as Y,H as r,y as z,R as ee,Z as te,f as A,t as B,z as M,U as se}from"../../../../../chunks/index-aedd6872.js";import{I as Z}from"../../../../../chunks/Input-ab618a3e.js";import"../../../../../chunks/forms-f02374ed.js";import{v as re}from"../../../../../chunks/utils-04416275.js";import{g as ae}from"../../../../../chunks/navigation-b75dba13.js";import{p as L,U as oe}from"../../../../../chunks/stores-3f27b470.js";import{c as ne}from"../../../../../chunks/schemas-fdc952c7.js";function le(g){let a,n,e,l,E,$,_,d,f,U,u,q,p,S,v,V,N,y,b,O,D,F,j;return f=new Z({props:{id:"oldPassword",label:"Old Password",type:"password",required:!0,errors:g[0]?.oldPassword}}),u=new Z({props:{id:"password",label:"New Password",type:"password",required:!0,errors:g[0]?.password}}),p=new Z({props:{id:"passwordConfirm",label:"Confirm New Password",type:"password",required:!0,errors:g[0]?.passwordConfirm}}),{c(){a=c("div"),n=c("div"),e=c("form"),l=c("h3"),E=H("Change Password"),$=P(),_=c("div"),d=P(),R(f.$$.fragment),U=P(),R(u.$$.fragment),q=P(),R(p.$$.fragment),S=P(),v=c("a"),V=H("I forgot my password"),N=P(),y=c("div"),b=c("button"),O=H("Update Password"),this.h()},l(t){a=w(t,"DIV",{class:!0});var m=h(a);n=w(m,"DIV",{class:!0});var I=h(n);e=w(I,"FORM",{class:!0});var s=h(e);l=w(s,"H3",{class:!0});var C=h(l);E=T(C,"Change Password"),C.forEach(i),$=x(s),_=w(s,"DIV",{class:!0}),h(_).forEach(i),d=x(s),k(f.$$.fragment,s),U=x(s),k(u.$$.fragment,s),q=x(s),k(p.$$.fragment,s),S=x(s),v=w(s,"A",{href:!0,class:!0});var G=h(v);V=T(G,"I forgot my password"),G.forEach(i),N=x(s),y=w(s,"DIV",{class:!0});var J=h(y);b=w(J,"BUTTON",{type:!0,class:!0});var K=h(b);O=T(K,"Update Password"),K.forEach(i),J.forEach(i),s.forEach(i),I.forEach(i),m.forEach(i),this.h()},h(){o(l,"class","text-2xl font-medium"),o(_,"class","divider"),o(v,"href","/reset-password"),o(v,"class","text-primary hover:cursor-point hover:underline"),o(b,"type","submit"),o(b,"class","btn btn-primary w-full max-w-lg"),o(y,"class","w-full max-w-lg pt-3"),o(e,"class","flex flex-col space-y-2 w-full"),o(n,"class","w-full"),o(a,"class","flex flex-col w-full h-full")},m(t,m){Y(t,a,m),r(a,n),r(n,e),r(e,l),r(l,E),r(e,$),r(e,_),r(e,d),z(f,e,null),r(e,U),z(u,e,null),r(e,q),z(p,e,null),r(e,S),r(e,v),r(v,V),r(e,N),r(e,y),r(y,b),r(b,O),D=!0,F||(j=ee(e,"submit",te(g[1])),F=!0)},p(t,[m]){const I={};m&1&&(I.errors=t[0]?.oldPassword),f.$set(I);const s={};m&1&&(s.errors=t[0]?.password),u.$set(s);const C={};m&1&&(C.errors=t[0]?.passwordConfirm),p.$set(C)},i(t){D||(A(f.$$.fragment,t),A(u.$$.fragment,t),A(p.$$.fragment,t),D=!0)},o(t){B(f.$$.fragment,t),B(u.$$.fragment,t),B(p.$$.fragment,t),D=!1},d(t){t&&i(a),M(f),M(u),M(p),F=!1,j()}}}function ie(g,a,n){let e;se(g,oe,$=>n(2,e=$));let l;async function E($){const{formData:_,err:d}=await re(new FormData($.target),ne);if(n(0,l=d?.fieldErrors),!d){try{await L.collection("users").update(e.id,_),L.authStore.clear()}catch{console.log(d.status,d.data)}ae("/login")}}return[l,E]}class he extends Q{constructor(a){super(),W(this,a,ie,le,X,{})}}export{he as default};
